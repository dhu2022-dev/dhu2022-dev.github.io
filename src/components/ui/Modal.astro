---
const { id = "modal", title = "Details" } = Astro.props;
---

<div id={id} style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.55); padding:24px; z-index:9999;">
  <div style="max-width: 780px; margin: 0 auto; background:#fff; border-radius:16px; padding:16px; position:relative;">
    <button type="button" data-close style="position:absolute; top:10px; right:10px;">âœ•</button>
    <h2 style="margin:0 0 10px;">{title}</h2>
    <div data-body>
      <slot />
    </div>
  </div>

  <script is:inline>
    (function () {
      var root = document.getElementById({JSON.stringify(id)});
      if (!root) return;

      var closeBtn = root.querySelector("[data-close]");

      function close() {
        root.style.display = "none";
        document.body.style.overflow = "";
      }

      function openWithHtml(html) {
        var body = root.querySelector("[data-body]");
        if (body) body.innerHTML = html || "<p>No details yet.</p>";
        root.style.display = "block";
        document.body.style.overflow = "hidden";
      }

      if (closeBtn) closeBtn.addEventListener("click", close);

      root.addEventListener("click", function (e) {
        if (e.target === root) close();
      });

      window.addEventListener("keydown", function (e) {
        if (e.key === "Escape") close();
      });

      // Expose open method globally
      window.__openModal = openWithHtml;
      window.__closeModal = close;
    })();
  </script>
</div>
