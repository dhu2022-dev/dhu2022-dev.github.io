---
const { id = "modal", title = "Details" } = Astro.props;
---

<div id={id} style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.55); padding:24px; z-index:9999;">
  <div style="max-width: 780px; margin: 0 auto; background:#fff; border-radius:16px; padding:16px; position:relative;">
    <button data-close style="position:absolute; top:10px; right:10px;">âœ•</button>
    <h2 style="margin:0 0 10px;">{title}</h2>
    <div data-body>
      <slot />
    </div>
  </div>

  <script>
    const root = document.getElementById({JSON.stringify(id)});
    const closeBtn = root?.querySelector("[data-close]");

    function close() {
      if (!root) return;
      root.style.display = "none";
      document.body.style.overflow = "";
    }

    closeBtn?.addEventListener("click", close);
    root?.addEventListener("click", (e) => {
      if (e.target === root) close();
    });

    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") close();
    });

    // Expose open/close for the page script:
    window.__openModal = (html) => {
      if (!root) return;
      const body = root.querySelector("[data-body]");
      if (body) body.innerHTML = html;
      root.style.display = "block";
      document.body.style.overflow = "hidden";
    };
  </script>
</div>
